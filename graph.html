<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Graph on a Canvas</title>
<style>
* {
	font-family: 'Droid Sans', 'Lucida Grande', 'Verdana';
	font-size: 10pt;
}
h1 {
	font-size: 2em;
}
h2 {
	font-size: 1.4em;
}
#myGraph {
	border: 1px solid #ccc;
}
#forceLayoutParameters {
  display: none;
}
.done {
}
#controls {
  padding: 1em 0;
}
ul, li {
  list-style: none;
  margin: 0 1.5em 0 0;
  padding: 0;
}
#controls li {
  float: left;
}
</style>
<!--[if IE]><script type="text/javascript" src="excanvas.compiled.js"></script><![endif]-->
<script src="default-layout.js"></script>
<script src="default-renderer.js"></script>
<script src="force-layout.js"></script>
<script src="circular-layout.js"></script>
<script src="graph.js"></script>
<script src="node.js"></script>

<script>
Style.Scene.background = "040507";

</script>

</head>

<body>

<h1>Canvas Based Graph Visualization</h1>

<canvas id="myGraph" width="940" height="600"></canvas>

<div id="controls">

<form>
  <ul>
    <li>
      <label for="layout">Layout</label>
      <select id="layout" name="layout" onchange="updateLayout()">
      <option value="default">Tile Based</option>
      <option value="force-layout">Force Directed</option>
      <option value="circular-layout">Circular</option>
      </select>
    </li>
    <li>
      <fieldset id="forceLayoutParameters">
      <input id="repulsiveForce">
      <input id="attractiveForce">
      <input id="attractiveEquilibrium">
      <input id="maximumChildren">
      <input id="maximumAncestors">
      </fieldset>
    </li>
    <li>
    <input type="button" value="Save Image" onclick="saveCanvas()" />
    </li>
  </ul>
</form>
</div>

<h2>Basic Controls</h2>
<ul class="tips">
<li class="done">Double click the graph drawing area to start/stop automatic layout.</li> 
<li class="done">Use your mousewheel to zoom in and out</li>
<li class="done">Click and drag a node to move it, this will also make it temporarily immune to layout forces.</li>
<li class="done">Click and drag the background to pan</li>
<li class="done">Double click a node to show/hide it's children.</li> 
<li class="done">One node selected at a time.</li> 
<li class="done">Detect node selection event.</li>
<li>TODO: Detect edge selection event.</li>
</ul>

<script><!--

var g = new Graph('myGraph');
g.add('foo');
g.connect('foo', 'bar', 'baz', 'grault','zork');
g.connect('grault', 'qux','quux');
g.connect('zork','smee','prosser','gru','phee','bor');
g.connect('foo','a');
g.connect('a','b');
g.connect('b','c');
g.connect('c','d');
g.connect('d','e');
g.connect('e','f');
g.connect('f','g');
g.connect('g','h');
g.connect('h','i');
g.connect('i','j');
g.connect('j','k');
g.connect('k','l');
g.connect('l','m');
g.connect('f','n');
g.connect('g','n');
g.connect('h','n');
g.connect('i','n');
g.connect('foo','g');
g.connect('phee','n');
g.connect('phee','m');

g.onNodeSelect(function (node) {
//	console.log(node.id);
});

g.onNodeHovered = function (node) {
//	console.log(node);
}

// Once the initial layout is done... switch to something fancy.
g.layout = new DefaultLayout(g);
g.applyLayout();
g.display.lookAt(g.nodes.foo);

function updateLayout() {
  g.stop();
  var selectedLayout = document.getElementById('layout').value;
  switch (selectedLayout) {
    case 'force-layout' :
      g.setLayout(new ForceDirectedLayout(g));
      break;
    case 'circular-layout' :
      g.setLayout(new CircularLayout(g));
      break;
    default :
      g.setLayout(new DefaultLayout(g));
      break;
  }
  if (!g.display.selection) {
    g.display.selection = g.nodes.foo;
  }
  g.display.lookAt(g.nodes.foo);
  g.start();
}

function saveCanvas() {
	g.save();
}

--></script>
</body>
</html>